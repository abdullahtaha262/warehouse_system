{% load static %}
{% load i18n %}

<!DOCTYPE html>
<html dir="rtl" lang="ar">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}المستودع{% endblock %}</title>
  <link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/base.css' %}">
  <style>
    body {
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    .sidebar {
      width: 250px;
      background-color: #222d32;
      color: white;
      display: flex;
      flex-direction: column;
      padding-top: 20px;
    }

    .sidebar a {
      color: white;
      padding: 15px;
      text-decoration: none;
      display: block;
      font-size: 1.1rem;
      transition: background 0.3s;
    }

    .sidebar a:hover {
      background-color: #1a2226;
    }

    .content {
      flex-grow: 1;
      padding: 20px;
      overflow-y: auto;
    }

    .active-link {
      background-color: #1a2226;
    }

    .dropdown-menu {
      background-color: #343a40;
      border: none;
    }

    .dropdown-menu a {
      color: white;
      padding: 10px 15px;
    }

    .dropdown-menu a:hover {
      background-color: #495057;
    }

    .sidebar .btn-outline-light {
      border-color: #ffffff;
      color: #ffffff;
      transition: all 0.3s;
    }

    .sidebar .btn-outline-light:hover {
      background-color: #ffffff;
      color: #343a40;
    }
  </style>
  {% block css %}{% endblock %}
</head>

<body>

  <!-- Sidebar -->
  <nav class="sidebar">
    <div class="text-center mb-4">
      <a href="{% url 'home' %}">
        <img src="{% static 'images/logo.png' %}" alt="Logo" width="200" height="120" class="rounded-circle">
        <h3 class="mt-2">المستودع</h3>
      </a>
    </div>
    <hr class="text-white">
    <a href="{% url 'home' %}" class="{% if request.resolver_match.url_name == 'home' %}active-link{% endif %}">
      <i class="bi bi-house-door"></i> {% trans 'الاجهزة والملحقات' %}
    </a>
    <a href="{% url 'about' %}" class="{% if request.resolver_match.url_name == 'about' %}active-link{% endif %}">
      <i class="bi bi-box-seam"></i> {% trans 'الطلبيات' %}
    </a>
    {% if user.is_superuser %}
    <a href="{% url 'manage_requests' %}" class="{% if request.resolver_match.url_name == 'manage_requests' %}active-link{% endif %}">
      <i class="bi bi-tools"></i> {% trans 'إدارة الطلبات' %}
    </a>
    {% endif %}
    <hr class="text-white">
    {% if user.is_authenticated %}
    <a href="#" class="dropdown-toggle" data-bs-toggle="dropdown">
      <i class="bi bi-gear"></i> {% trans 'الضبط' %}
    </a>
    <ul class="dropdown-menu">
      <li><a class="dropdown-item" href="#">{{ user.email }}</a></li>
      <li><a class="dropdown-item" href="{% url 'account_change_password' %}">
          {% trans 'تغيير كلمة المرور' %}</a></li>
      <li><a class="dropdown-item" href="{% url 'account_logout' %}">{% trans 'تسجيل الخروج' %}</a></li>
    </ul>
    {% else %}
    <a href="{% url 'account_login' %}" class="btn btn-outline-light mt-auto mx-3">{% trans 'تسجيل الدخول' %}</a>
    {% endif %}
  </nav>

  <!-- Main Content Area -->
  <div class="content">
    {% if messages %}
    <div class="container">
      {% for message in messages %}
      <div class="alert {{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
      {% endfor %}
    </div>
    {% endif %}
    
    {% block content %}
    <!-- Default content if none provided -->
    {% endblock %}
  </div>

  {% block javascript %}
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="{% static 'js/base.js' %}"></script>
  {% endblock %}
</body>

</html>
